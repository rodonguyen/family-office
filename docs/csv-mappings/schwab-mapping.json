{
  "broker": "Charles Schwab",
  "status": "coming_soon",
  "last_updated": "2026-01-16",
  "notes": "CSV format mapping based on standard Schwab exports. Automated parsing will be implemented in future release.",
  "positions_csv": {
    "file_pattern": "schwab_positions_*.csv",
    "expected_columns": {
      "symbol": {
        "schwab_column": "Symbol",
        "data_type": "string",
        "example": "TSLA",
        "finance_guru_field": "ticker"
      },
      "quantity": {
        "schwab_column": "Quantity",
        "data_type": "number",
        "example": "74",
        "finance_guru_field": "shares"
      },
      "price": {
        "schwab_column": "Price",
        "data_type": "currency",
        "example": "$448.96",
        "finance_guru_field": "current_price"
      },
      "price_paid": {
        "schwab_column": "Price Paid",
        "data_type": "currency",
        "example": "$234.19",
        "finance_guru_field": "average_cost_basis"
      },
      "market_value": {
        "schwab_column": "Market Value",
        "data_type": "currency",
        "example": "$33223.04",
        "finance_guru_field": "current_value"
      },
      "gain_loss": {
        "schwab_column": "Gain/Loss $",
        "data_type": "currency",
        "example": "+$15892.97",
        "finance_guru_field": "total_gain_loss_dollar"
      },
      "gain_loss_percent": {
        "schwab_column": "Gain/Loss %",
        "data_type": "percentage",
        "example": "+91.70%",
        "finance_guru_field": "total_gain_loss_percent"
      }
    },
    "manual_mapping_required": true,
    "header_row": 1,
    "data_starts_row": 2,
    "encoding": "utf-8",
    "delimiter": ",",
    "notes": "Schwab typically exports positions with simplified column names. May include account type in separate column."
  },
  "balances_csv": {
    "file_pattern": "schwab_balances_*.csv",
    "expected_fields": {
      "cash_available": {
        "schwab_key": "Cash Available to Trade",
        "data_type": "currency",
        "finance_guru_field": "settled_cash"
      },
      "margin_balance": {
        "schwab_key": "Margin Balance",
        "data_type": "currency",
        "finance_guru_field": "net_debit",
        "notes": "May be positive value (needs negation)"
      },
      "account_value": {
        "schwab_key": "Account Value",
        "data_type": "currency",
        "finance_guru_field": "total_account_value"
      }
    },
    "manual_mapping_required": true,
    "format_notes": "Schwab balances may be in single-row or key-value format depending on export method"
  },
  "transaction_history_csv": {
    "file_pattern": "schwab_transactions_*.csv",
    "expected_columns": {
      "date": {
        "schwab_column": "Date",
        "data_type": "date",
        "finance_guru_field": "run_date"
      },
      "action": {
        "schwab_column": "Action",
        "data_type": "string",
        "finance_guru_field": "action"
      },
      "symbol": {
        "schwab_column": "Symbol",
        "data_type": "string",
        "finance_guru_field": "symbol"
      },
      "description": {
        "schwab_column": "Description",
        "data_type": "string",
        "finance_guru_field": "description"
      },
      "quantity": {
        "schwab_column": "Quantity",
        "data_type": "number",
        "finance_guru_field": "quantity"
      },
      "price": {
        "schwab_column": "Price",
        "data_type": "currency",
        "finance_guru_field": "price"
      },
      "amount": {
        "schwab_column": "Amount",
        "data_type": "currency",
        "finance_guru_field": "amount"
      }
    },
    "manual_mapping_required": true
  },
  "parsing_notes": {
    "currency_format": "US format with $ prefix or without, commas for thousands",
    "percentage_format": "Decimal with % or without",
    "date_format": "MM/DD/YYYY or YYYY-MM-DD",
    "special_handling": "Schwab may include account number in first column of every row"
  },
  "validation_rules": {
    "positions": [
      "Symbol must not be empty",
      "Quantity must be positive",
      "Price Paid must be positive (average cost basis)"
    ],
    "balances": [
      "Account Value must be positive",
      "Margin Balance may need sign conversion"
    ]
  },
  "onboarding_workflow": {
    "step_1": "User exports CSV from Schwab",
    "step_2": "Finance Guru detects non-Fidelity format",
    "step_3": "User selects 'Charles Schwab' from broker list",
    "step_4": "System presents expected columns and asks user to confirm mapping",
    "step_5": "User maps Schwab columns to Finance Guru fields",
    "step_6": "Mapping saved for future imports"
  }
}
