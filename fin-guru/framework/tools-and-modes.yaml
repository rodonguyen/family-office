# Finance Guru Tools & Modes Configuration

## Available Tools
tools:
  exa:
    type: mcp
    purpose: "Deep market research: securities, fundamentals, competitive landscape, institutional holdings"

  web-search-tool:
    type: mcp
    purpose: "Real-time news: Fed, earnings, macro indicators, dividend announcements"

  gdrive:
    type: mcp
    purpose: "Google Sheets operations: read/write portfolio tracker, update dividend tracker, margin dashboard"
    spreadsheet_id: "1HtHRP3CbnOePb8RQ0RwzFYOQxk0uWC6L8ZMJeQYfWk4"
    safety_rules: "Follow spreadsheet-architecture.md rules - only write to allowed columns (A,B,G)"

  cli-tools:
    type: local_python
    location: "src/"
    purpose: "Quantitative analysis: risk metrics, momentum, volatility, correlation, backtesting, optimization"
    execution: "uv run python src/{tool_path} {ticker} [flags]"
    tools:
      - "analysis/risk_metrics_cli.py - VaR, CVaR, Sharpe, Sortino, Max DD, Beta, Alpha"
      - "utils/momentum_cli.py - RSI, MACD, Stochastic, Williams %R, ROC, confluence"
      - "utils/volatility_cli.py - Bollinger Bands, ATR, Historical Vol, Keltner, regime"
      - "utils/moving_averages_cli.py - SMA, EMA, WMA, HMA, Golden/Death Cross"
      - "analysis/correlation_cli.py - Pearson matrix, covariance, diversification"
      - "strategies/backtester_cli.py - Strategy validation, performance metrics"
      - "strategies/optimizer_cli.py - Mean-Variance, Risk Parity, Max Sharpe, Black-Litterman"

## Operating Modes
modes:
  conversational:
    default: true
    use_when: "General discussion, coaching, scoping, prioritization, quick Q&A"
    behavior: "Explain clearly, propose next steps, and keep agency with the user"

  teaching:
    use_when: "User asks to learn concepts (e.g., options Greeks, VaR, factor tilts)"
    behavior: "Explain like a mentor; include small worked examples; invite a hands-on mini task"

  research:
    use_when: "Security-specific questions, market conditions, policy changes, product specs, or any fact likely to change"
    preferred_tools: ["exa", "web-search-tool"]
    policy: "Cite sources; separate facts from assumptions; timestamp sensitive data; run date command for temporal awareness"

  quantitative-analysis:
    use_when: "Running risk metrics, technical analysis, backtesting, portfolio optimization, correlation analysis"
    required_tool: "cli-tools"
    execution_policy:
      - "Use uv run python src/{tool} {ticker} [flags]"
      - "Check tool documentation in CLAUDE.md or tool --help for flags"
      - "Save outputs to fin-guru-private/fin-guru/reports/ or fin-guru-private/fin-guru/analysis/"
      - "Summarize results clearly; cite metrics with values and dates"
    examples:
      - "uv run python src/analysis/risk_metrics_cli.py PLTR --days 252"
      - "uv run python src/utils/momentum_cli.py TSLA --indicator rsi"
      - "uv run python src/strategies/backtester_cli.py JEPI --strategy buy-hold"

  modeling:
    use_when: "User requests working Excel models, dashboards, or scenario tools"
    depends_on: ["quantitative-analysis"]
    specification:
      workbook_tabs:
        - name: "Inputs"
          features: ["data validation", "scenario selectors"]
        - name: "Calculations"
          features: ["transparent formulas", "no hard-coded outputs"]
        - name: "Scenarios"
          features: ["bull/base/bear", "sensitivity tables"]
        - name: "Risk"
          features: ["VaR", "drawdown", "stress cases"]
        - name: "Outputs"
          features: ["charts", "KPIs", "print-ready tables"]
      charts:
        [
          "Line/Bar for trends",
          "Tornado for sensitivity",
          "Histogram for distributions",
          "Waterfall for contributions",
        ]
      quality:
        [
          "No circular references unless intentional with toggles",
          "named ranges for clarity",
          "color-coded inputs",
        ]

  spreadsheet-ops:
    use_when: "Updating portfolio tracker, dividend tracker, margin dashboard in Google Sheets"
    required_tool: "gdrive"
    policy:
      - "MUST follow spreadsheet-architecture.md rules"
      - "Portfolio Positions: only write columns A (Ticker), B (Quantity), G (Avg Cost Basis)"
      - "NEVER touch Column C (Google Finance formulas) or other formula columns"
      - "Check agent permission matrix before writing"
      - "Use safety gates: stop on position mismatches, >10% quantity changes, >20% cost basis changes"
